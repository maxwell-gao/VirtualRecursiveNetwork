name: recursive_reasoning.loop_transformer@LoopTransformerModel_ACT
loss:
  name: losses@CrossEntropyLossHead
  loss_type: stablemax_cross_entropy
  mask_penalty_weight: 0.0

# Disable ACT and DIS
halt_exploration_prob: 0.0
halt_max_steps: 1 # Not used when ACT is disabled, but required
act_enabled: false
act_inference: false
no_ACT_continue: false

dis_enabled: false

hidden_size: 512
num_heads: 8
expansion: 4

puzzle_emb_ndim: ${.hidden_size}
puzzle_emb_len: 16

pos_encodings: rope
forward_dtype: bfloat16
dropout: 0.0

# Fixed number of cycles (no adaptive computation)
outer_cycles: 3
warmup_cycles: 0

states:
  - name: z_H
    layers: 1
  - name: z_L
    layers: 1
    share_weights_with: z_H

stages:
  - target: z_L
    sources: [z_H]
    include_inputs: true
    repeat: 6
  - target: z_H
    sources: [z_L]
    repeat: 3

readout_state: z_H
halt_state: z_H
